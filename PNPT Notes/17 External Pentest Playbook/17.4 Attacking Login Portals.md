Overview and Strategy
	Should have a list of possible employees at this point
	Trying passwords with current season and year and other common ones
		Can also back date since some places don't have 90 day password expire
		Location, sports teams, address numbers, etc
	Verifying correct emails with login portals if possible
	Make sure you know about any lockout policy so as to not lock accounts

Attacking O365
	Password spraying - Using multiple accounts with some common passwords.
	If you can get account info from O365, then AD is likely the same with the username as the email or without the @company.com extension.
		Tools
	blacklanternsecurity / TREVORspray - github
		`pip install git+https://github.com/blacklanternsecurity/trevorproxy`
			Some interesting options
				-e will take a list of emails, validate it and then go forward with trying passwords, bypassing invalid emails.
				--passwords  - either a txt doc or 'password' in quotes
				--delay 15  - will set a delay of 15 seconds between each attempt
				--no-current-ip --ssh   - Will use ssh to try each attempt from a differernt device, depending on how many devices you want to cycle through.  Does require some setup.
					In order to set this up, you can use AWS, free tier machines.  Create one and then duplicate that one.  Set all to same key pair.  Verify the login manually from the same device before starting the tool and accept the fingerprint or the tool will break.
				-k keypair.pem    - this will follow the list of machines to ssh into (ubuntu@publicIP) and this will enable the use of multiple devices.

Attacking OWA
	Metasploit has OWA attacks.  Search will give you `auxiliary/scanner/http/owa_login`
		This can be used for spraying and stuffing.
		`show options` give you a number of options to use
		Not as often to get blocked with OWA
		May need to change Auxiliary Action to different OWA version
		This will also give you a list of usernames that have been validated
		Will not auto stop if accounts lock out so keep an eye on this

Attacking Other Portals
	Burpsuite Intruder can be used for items that are not Outlook/Microsoft related.
		Checking things like response code and response size can point out different results
	Again.  Still watch for getting account lockout responses.

Bypassing MFA
	If you are unable to do social engineering, we're limited but there are some tools
		dafthack / MFASweep   - github
			This tool will go through and see if things have MFA enabled
			Does require having a good account and password